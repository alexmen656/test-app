(()=>{var e={};e.id=936,e.ids=[936],e.modules={619:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/pe/Project/nextjs/beta-bay/app/myapps/edit/[id]/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/pe/Project/nextjs/beta-bay/app/myapps/edit/[id]/page.tsx","default")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1505:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(687),a=r(3210),o=r(474);let i=({label:e,id:t,type:r="text",placeholder:a,value:o,onChange:i,as:n})=>(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:t,className:"block text-sm font-medium text-gray-600 mb-1",children:e}),"textarea"===n?(0,s.jsx)("textarea",{id:t,name:t,rows:4,className:"w-full px-4 py-2 bg-gray-100 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:a,value:o,onChange:i}):(0,s.jsx)("input",{type:r,id:t,name:t,className:"w-full px-4 py-2 bg-gray-100 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:a,value:o,onChange:i})]}),n=({path:e,className:t="h-6 w-6"})=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:e})}),l=()=>(0,s.jsx)(n,{path:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12",className:"h-8 w-8 text-gray-400"}),d=({label:e,id:t,onChange:r,previewUrl:a,multiple:i=!1})=>(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:e}),(0,s.jsx)("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:(0,s.jsxs)("div",{className:"space-y-1 text-center",children:[a?(0,s.jsx)("div",{className:"mx-auto h-24 w-24 relative rounded-md overflow-hidden",children:(0,s.jsx)(o.default,{src:a,alt:"Preview",fill:!0,className:"object-cover"})}):(0,s.jsx)(l,{}),(0,s.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,s.jsxs)("label",{htmlFor:t,className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[(0,s.jsx)("span",{children:"Upload a file"}),(0,s.jsx)("input",{id:t,name:t,type:"file",className:"sr-only",onChange:r,multiple:i,accept:"image/*"})]}),(0,s.jsx)("p",{className:"pl-1",children:"or drag and drop"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]})})]});var c=r(6189),p=r(9556);let u=()=>{let e=(0,c.useRouter)(),t=(0,c.useParams)(),r="new"!==t.id,[n,l]=(0,a.useState)({name:"",description:"",videoUrl:"",iosLink:"",androidLink:"",googleGroupLink:"",testingInstruction:"",price:0,icon:null,coverImage:null,screenshots:[]}),[u,m]=(0,a.useState)({screenshots:[]}),[h,g]=(0,a.useState)(!1),[x,b]=(0,a.useState)(!1),[f,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{if(r){b(!0),y(null);try{let e=(0,p.w)(),r=t.id,s=localStorage.getItem("betabay_token"),a={};s&&(a.Authorization=`Bearer ${s}`);let o=await fetch(`${e}/api/test-posts/${r}`,{method:"GET",headers:a});if(!o.ok)throw Error(`Failed to fetch app data: ${o.status}`);let i=await o.json();console.log("Fetched app data:",i),l({name:i.name||i.app_name||"",description:i.description||"",videoUrl:i.videoUrl||i.youtube_link||"",iosLink:i.iosLink||i.ios_link||"",androidLink:i.androidLink||i.android_link||"",googleGroupLink:i.googleGroupLink||i.google_group_link||"",testingInstruction:i.testingInstruction||i.testing_instruction||"",price:"string"==typeof i.price?parseFloat(i.price):i.price||0,icon:null,coverImage:null,screenshots:[]});let n={screenshots:[]};(i.iconUrl||i.icon_url)&&(n.icon=i.iconUrl||i.icon_url),(i.coverImageUrl||i.cover_image_url)&&(n.coverImage=i.coverImageUrl||i.cover_image_url),(Array.isArray(i.screenshots)||Array.isArray(i.screenshot_urls))&&(n.screenshots=i.screenshots||i.screenshot_urls||[]),m(n)}catch(e){console.error("Error fetching app data:",e),y("Failed to load app data. Please try again.")}finally{b(!1)}}})()},[r,t.id]);let v=e=>{let{name:t,value:r,type:s}=e.target;l(e=>({...e,[t]:"number"===s?parseFloat(r):r}))},j=e=>{let{name:t,files:r}=e.target;if(r&&0!==r.length)if("screenshots"===t){let e=Array.from(r);l(t=>({...t,screenshots:[...t.screenshots,...e]}));let t=e.map(e=>URL.createObjectURL(e));m(e=>({...e,screenshots:[...e.screenshots,...t]}))}else{let e=r[0];l(r=>({...r,[t]:e})),m(r=>({...r,[t]:URL.createObjectURL(e)}))}},w=async s=>{if(s.preventDefault(),!n.name.trim())return void alert("App Name is required.");g(!0);try{let s=(0,p.w)(),a={app_name:n.name,description:n.description,youtube_link:n.videoUrl,ios_link:n.iosLink,android_link:n.androidLink,google_group_link:n.googleGroupLink,testing_instruction:n.testingInstruction,test_price:n.price,user_info:{username:localStorage.getItem("betabay_username")||"",profile_image:localStorage.getItem("betabay_profile_image")||"",user_id:localStorage.getItem("betabay_user_id")||""}},o=localStorage.getItem("betabay_token"),i={"Content-Type":"application/json"};o&&(i.Authorization=`Bearer ${o}`);let l=r?`${s}/api/test-posts/${t.id}`:`${s}/api/test-posts`,d=await fetch(l,{method:r?"PUT":"POST",headers:i,body:JSON.stringify(a)});if(!d.ok)throw Error(`Error ${r?"updating":"creating"} app: ${d.status}`);let c=await d.json();console.log(`App ${r?"updated":"created"} successfully:`,c),e.push("/myapps")}catch(e){console.error(`Failed to ${r?"update":"create"} app:`,e),alert(`Failed to ${r?"update":"create"} app. Please try again.`)}finally{g(!1)}};return(0,s.jsxs)("div",{className:"max-w-5xl mx-auto mb-10",children:[(0,s.jsxs)("header",{className:"my-10",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-800",children:r?"Edit App":"Post a New App"}),(0,s.jsx)("p",{className:"text-gray-500 mt-1",children:r?"Update the details below to modify your app information.":"Fill in the details below to get your app ready for testing."})]}),x?(0,s.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"}),(0,s.jsx)("p",{className:"ml-3 text-lg text-gray-600",children:"Loading app data..."})]}):f?(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6",children:[(0,s.jsx)("p",{className:"font-medium",children:"Error"}),(0,s.jsx)("p",{children:f}),(0,s.jsx)("button",{onClick:()=>e.push("/myapps"),className:"mt-2 px-4 py-2 bg-red-100 text-red-800 rounded-md hover:bg-red-200",children:"Return to My Apps"})]}):(0,s.jsxs)("form",{onSubmit:w,className:"space-y-12",children:[(0,s.jsxs)("div",{className:"p-8 bg-white border border-gray-200 rounded-2xl shadow-sm",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-6",children:"Core Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsx)("div",{className:"md:col-span-1",children:(0,s.jsx)(d,{label:"App Icon",id:"icon",onChange:j,previewUrl:u.icon})}),(0,s.jsxs)("div",{className:"md:col-span-2 space-y-4",children:[(0,s.jsx)(i,{label:"App Name",id:"name",placeholder:"My Awesome App",value:n.name,onChange:v}),(0,s.jsx)(i,{label:"Description",id:"description",as:"textarea",placeholder:"A brief, catchy description of your app.",value:n.description,onChange:v})]})]})]}),(0,s.jsxs)("div",{className:"p-8 bg-white border border-gray-200 rounded-2xl shadow-sm",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-6",children:"Media & Visuals"}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(d,{label:"Cover Image",id:"coverImage",onChange:j,previewUrl:u.coverImage}),(0,s.jsx)(d,{label:"Screenshots (Select multiple)",id:"screenshots",onChange:j,multiple:!0}),u.screenshots.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2",children:u.screenshots.map((e,t)=>(0,s.jsx)("div",{className:"relative w-full aspect-square rounded-md overflow-hidden",children:(0,s.jsx)(o.default,{src:e,fill:!0,className:"object-cover",alt:`Screenshot ${t+1}`})},t))}),(0,s.jsx)(i,{label:"YouTube Link (Optional)",id:"videoUrl",placeholder:"https://youtube.com/watch?v=...",value:n.videoUrl??"",onChange:v})]})]}),(0,s.jsxs)("div",{className:"p-8 bg-white border border-gray-200 rounded-2xl shadow-sm",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-6",children:"Testing & Distribution"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)(i,{label:"iOS Test Link (TestFlight)",id:"iosLink",placeholder:"https://testflight.apple.com/join/...",value:n.iosLink??"",onChange:v}),(0,s.jsx)(i,{label:"Android Test Link (Play Store)",id:"androidLink",placeholder:"https://play.google.com/apps/testing/...",value:n.androidLink??"",onChange:v}),(0,s.jsx)(i,{label:"Google Group Link (Optional)",id:"googleGroupLink",placeholder:"https://groups.google.com/g/...",value:n.googleGroupLink??"",onChange:v}),(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)(i,{label:"Testing Instructions",id:"testingInstruction",as:"textarea",placeholder:"e.g., 'Log in with user: test@test.com, pass: 1234. Then, navigate to the dashboard and try creating a new project.'",value:n.testingInstruction,onChange:v})}),(0,s.jsx)(i,{label:"Price ($)",id:"price",type:"number",placeholder:"0.00",value:n.price,onChange:v})]})]}),(0,s.jsxs)("div",{className:"flex justify-end items-center gap-4 pt-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{e.push("/myapps")},disabled:h,className:"px-6 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition disabled:opacity-50",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:h,className:"px-8 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transform hover:scale-105 transition disabled:opacity-50 disabled:transform-none",children:h?r?"Updating...":"Posting...":r?"Update App":"Post App"})]})]})]})}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3747:(e,t,r)=>{Promise.resolve().then(r.bind(r,1505))},3873:e=>{"use strict";e.exports=require("path")},6055:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(1658);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},6189:(e,t,r)=>{"use strict";var s=r(5773);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},7723:(e,t,r)=>{Promise.resolve().then(r.bind(r,619))},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")},9556:(e,t,r)=>{"use strict";function s(){return process.env.NEXT_PUBLIC_BACKEND_URL2||"https://betbay-backend.vercel.app"}r.d(t,{w:()=>s})},9618:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d});var s=r(5239),a=r(8088),o=r(8170),i=r.n(o),n=r(893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let d={children:["",{children:["myapps",{children:["edit",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,619)),"/Users/pe/Project/nextjs/beta-bay/app/myapps/edit/[id]/page.tsx"]}]},{}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,6055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,8014)),"/Users/pe/Project/nextjs/beta-bay/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,6055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/pe/Project/nextjs/beta-bay/app/myapps/edit/[id]/page.tsx"],p={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/myapps/edit/[id]/page",pathname:"/myapps/edit/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,523,658,194],()=>r(9618));module.exports=s})();